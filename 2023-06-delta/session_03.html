<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>NCEAS Open Science Synthesis for the Delta Science Program - 3&nbsp; Literate Analysis with Quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./session_04.html" rel="next">
<link href="./session_02.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./session_03.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Literate Analysis with Quarto</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Literate Analysis with Quarto</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Course Materials</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://www.nceas.ucsb.edu/learning-hub" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-door-fill"></i></a>
    <a href="https://twitter.com/ucsb_nceas" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/NCEAS/nceas-training/tree/2023-06-delta" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">RStudio Server Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><code>Git</code> and GitHub Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_03.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Literate Analysis with Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">LEGO® Reproducibility Activity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Accessing and Publishing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logic Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to Git and GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reproducible Data Access</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Modeling Essentials</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hands On Synthesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Cleaning and Wrangling Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Practice: Cleaning and Wrangling Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Hands on Synthesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Creating Functions in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Creating R Packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">FAIR and CARE principles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Collaborating using Git and GitHub &amp; Merge Conflicts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Hands on Synthesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Reproducibility &amp; Provenance</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a></li>
  <li><a href="#literate-programming" id="toc-literate-programming" class="nav-link" data-scroll-target="#literate-programming"><span class="header-section-number">3.2</span> Literate Programming</a></li>
  <li><a href="#rmarkdown-and-quarto" id="toc-rmarkdown-and-quarto" class="nav-link" data-scroll-target="#rmarkdown-and-quarto"><span class="header-section-number">3.3</span> RMarkdown and Quarto</a></li>
  <li><a href="#a-quarto-document" id="toc-a-quarto-document" class="nav-link" data-scroll-target="#a-quarto-document"><span class="header-section-number">3.4</span> A Quarto Document</a></li>
  <li><a href="#markdown-syntax" id="toc-markdown-syntax" class="nav-link" data-scroll-target="#markdown-syntax"><span class="header-section-number">3.5</span> Markdown Syntax</a></li>
  <li><a href="#the-visual-editor" id="toc-the-visual-editor" class="nav-link" data-scroll-target="#the-visual-editor"><span class="header-section-number">3.6</span> The Visual Editor</a>
  <ul class="collapse">
  <li><a href="#adding-citations" id="toc-adding-citations" class="nav-link" data-scroll-target="#adding-citations"><span class="header-section-number">3.6.1</span> Adding citations</a></li>
  <li><a href="#adding-table-in-markdown" id="toc-adding-table-in-markdown" class="nav-link" data-scroll-target="#adding-table-in-markdown"><span class="header-section-number">3.6.2</span> Adding table in markdown</a></li>
  </ul></li>
  <li><a href="#code-chunks-in-quarto" id="toc-code-chunks-in-quarto" class="nav-link" data-scroll-target="#code-chunks-in-quarto"><span class="header-section-number">3.7</span> Code Chunks in Quarto</a></li>
  <li><a href="#practice-literate-analysis-with-ocean-water-samples" id="toc-practice-literate-analysis-with-ocean-water-samples" class="nav-link" data-scroll-target="#practice-literate-analysis-with-ocean-water-samples"><span class="header-section-number">3.8</span> Practice: Literate Analysis with ocean water samples</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">3.8.1</span> Getting Started</a></li>
  <li><a href="#read-in-the-data" id="toc-read-in-the-data" class="nav-link" data-scroll-target="#read-in-the-data"><span class="header-section-number">3.8.2</span> Read in the data</a></li>
  <li><a href="#calculate-summary-statistics" id="toc-calculate-summary-statistics" class="nav-link" data-scroll-target="#calculate-summary-statistics"><span class="header-section-number">3.8.3</span> Calculate Summary Statistics</a></li>
  </ul></li>
  <li><a href="#quarto-file-paths-and-environement" id="toc-quarto-file-paths-and-environement" class="nav-link" data-scroll-target="#quarto-file-paths-and-environement"><span class="header-section-number">3.9</span> Quarto file paths and environement</a>
  <ul class="collapse">
  <li><a href="#practice-quarto-and-environments" id="toc-practice-quarto-and-environments" class="nav-link" data-scroll-target="#practice-quarto-and-environments"><span class="header-section-number">3.9.1</span> Practice: Quarto and Environments</a></li>
  </ul></li>
  <li><a href="#additional-quarto-resources" id="toc-additional-quarto-resources" class="nav-link" data-scroll-target="#additional-quarto-resources"><span class="header-section-number">3.10</span> Additional Quarto Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Introduce literate analysis using Quarto (an extension of RMarkdown’s features)</li>
<li>Learn markdown syntax and run R code using Quarto</li>
<li>Build and render an example analysis</li>
</ul>
</section>
<section id="introduction" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1</span> Introduction</h2>
</section>
<section id="literate-programming" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="literate-programming"><span class="header-section-number">3.2</span> Literate Programming</h2>
<p>All too often, computational methods are written in such a way as to be borderline incomprehensible even to the person who originally wrote the code! The reason for this is obvious, computers interpret information very differently than people do. In 1984, Donald Knuth proposed a reversal of the programming paradigm by introducing the concept of <em>Literate Programming</em> (<a href="http://www.literateprogramming.com/knuthweb.pdf">Knuth 1984</a>).</p>
<blockquote class="blockquote">
<p><em>“Instead of imagining that our main task is to instruct a computer what to do, let us concentrate rather on explaining to human beings what we want a computer to do.”</em></p>
</blockquote>
<p>If our aim is to make scientific research more transparent, the appeal of this paradigm reversal is immediately apparent. By switching to a literate analysis model, <strong>you help enable human understanding of what the computer is doing</strong>. As Knuth describes, in the literate analysis model, the author is an “<em>essayist</em>” who chooses variable names carefully, explains what they mean, and introduces concepts in the analysis in a way that facilitates understanding.</p>
<p>Quarto and RMarkdown are an excellent way to generate literate analysis, and a reproducible workflow. These types of files, combine R the programming language, and <strong>markdown, a set of text formatting directives</strong>.</p>
<p>In an R script, the language assumes that you are writing R code, unless you specify that you are writing prose (using a comment, designated by <code>#</code>). The paradigm shift of literate analysis comes in the switch to RMarkdown or Quarto, where instead of assuming you are writing code, they assume that you are writing prose unless you specify that you are writing code. This, along with the formatting provided by markdown, encourages the “essayist” to write understandable prose to accompany the code that explains to the human-beings reading the document what the author told the computer to do. This is in contrast to writing just R code, where the author telling to the computer what to do with maybe a smattering of terse comments explaining the code to a reader.</p>
<!-- NEED to update -->
<p>Before we dive in deeper, let’s look at an example of what a rendered literate analysis with Quarto/RMarkdown?? can look like using a real example. <a href="https://nceas.github.io/sasap-training/materials/reproducible_research_in_r_fairbanks/example-brood-table-analysis.html">Here is an example</a> of an analysis workflow written using Quarto. <!-- UPDATE THE LINK TO QUARTO ANALYISIS--></p>
<p>There are a few things to notice about this document, which assembles a set of similar data sources on salmon brood tables with different formatting into a single data source.</p>
<ul>
<li>It introduces the data sources using in-line images, links, interactive tables, and interactive maps.</li>
<li>An example of data formatting from one source using R is shown.</li>
<li>The document executes a set of formatting scripts in a directory to generate a single merged file.</li>
<li>Some simple quality checks are performed (and their output shown) on the merged data.</li>
<li>Simple analysis and plots are shown.</li>
</ul>
<p>In addition to achieving literate analysis, this document also represents a <strong>reproducible analysis</strong>. Because the entire merging and quality control of the data is done using the R code in the Quarto file, if a new data source and formatting script are added, the document can be run all at once with a single click to re-generate the quality control, plots, and analysis of the updated data.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A note on reproducibility
</div>
</div>
<div class="callout-body-container callout-body">
<p>Reproducible analysis allow you to automatize how the figures and the statistics in your analysis are generated. This process also helps your collaborators, your readers and your future self to follow your code trail the leads to the original data, increasing the transparency of your science.</p>
<p>Literate analysis help reduce the mistakes from copying and pasting across software, keeps results and models in sync, and allows you to provide interested readers with more information about the different approaches and analyses you tried before coming up with the final results <!--[CITE: https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf].--></p>
</div>
</div>
</section>
<section id="rmarkdown-and-quarto" class="level2 page-columns page-full" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="rmarkdown-and-quarto"><span class="header-section-number">3.3</span> RMarkdown and Quarto</h2>
<p>You can identify a Quarto file with the <code>.qmd</code> extension. On the other hand, am RMarkdown file has a <code>.Rmd</code> extension. Both have similar structures and both combine prose with code.Quarto provides a rich support to languages other than R such as Python, Observable, and Julia. It also excels in formatting and layout. Allowing users to customize in details the looks of the rendered documents. On the other hand, RMarkdown is compatible with some languages that Quarto is not, for example bash. Quarto and Rmarkdown are amazing tools to use for collaborative research. During this course e will spend some time learning and using the basics of Quarto and provide some comparisons to RMarkdown.</p>
<p><img src="images/quarto-rmd-logo.png" class="img-fluid" alt="Bui &amp; Csik, 2023, SORTEE"></p>
<p>Now, let’s take a look at the structure of each of these files. The both look for the most part the same with minor differences.</p>
<div class="column-page">
<p><img src="images/quarto-rmd-structure.png" class="img-fluid" alt="Bui &amp; Csik, 2023, SORTEE"></p>
<p>Finally, lets compare each of these files when knitted/rendered.</p>
<p><img src="images/quarto-rmd-rendered.png" class="img-fluid" alt="Bui &amp; Csik, 2023, SORTEE"></p>
</div>
<p>Again, we see similar outcoumes, with minor differences mainly in formatting (font, style of showing code chunks, etc.)</p>
<p>Both type of documents have three main components:</p>
<ul>
<li>YAML metadata to guide the document’s build process</li>
<li>Code chunks to run</li>
<li>Prose (Text to display)</li>
</ul>
<p>Today we are going to use Quarto to run some analysis on data. We are specifically going to focus on the code chunk and text components. We will discuss more about the how the YAML works in an Quarto later in the course.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The YAML
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is the document’s metadata which sets guidelines on how your want the output of your document to look like. It is located at the top of your file, delineated by three dashes (—) at the top and at the bottom of it. It can be used to specify: - Characteristics of your documents such at title, author, date of creation. - Argument to pass on the building process to control the format of the output. - Add additional information such as the bibliography file (and formatting of the references) - Specific parameters for your report (eg: just used a subset of the data).</p>
</div>
</div>
</section>
<section id="a-quarto-document" class="level2 page-columns page-full" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="a-quarto-document"><span class="header-section-number">3.4</span> A Quarto Document</h2>
<p>Let’s open an Quarto file following the instructions below.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Open a new Quarto file using the following prompts: File &gt; New File &gt; Quarto Document</li>
<li>A popup window will appear.</li>
<li>Give your file a new title, e.g “Introduction to Quarto”.</li>
<li>Leave the output format as HTML and Engine set to Knitr.</li>
<li>Then click the “Create” button.</li>
</ul>
</div>
</div>
<p>The first thing to notice is that by opening a file, we see the fourth pane of the RStudio pops up. This is our Quarto document which is essentially a text editor. We also see in the upper left side that we are looking at the document under the “Visual editor”. This is probably a familiar way of looking at a text document. To introduce the <strong>markdown</strong> syntax, we re going to move to the source editor and then come back to the visual editor. In the upper left corner, click on Source. See how the formatting changed? In the Source editor we are looking at the same text, but in markdown syntax. The visual editor on the other hand, allows us to see how markdown is rendered, therefore how is it going to look in our output document.</p>
<p>Let’s have a look at this file — As we saw in the examples above, it looks a little different than a R script. It’s not blank; there is some initial text already provided for you. Lets identify the three main components we introduces before. We have the YAML a the top, in between the two sets of dashed lines. Then we also see white and grey sections. The gray sections are R code chunks and the white sections are plain text.</p>
<p>Let’s go ahead and render this file by clicking the “Render” button, next to the blue arrow at the top of the Quarto file. When you first click this button, RStudio will prompt you to save this file. Save it in the top level of your home directory on the server, and name it something that you will remember (like <code>quarto-intro.Rmd</code>).</p>
<div class="column-page">
<p><img src="images/quarto-side-by-side.png" class="img-fluid"></p>
</div>
<p>What do you notice between the two?</p>
<p>First, the render process produced a second file (an HTML file) that popped up in a second window in the browser. You’ll also see this file in your directory with the same name as your qmd, but with the .html extension. In it’s simplest format, Quarto files come in pairs (same than RMarkdown files) the Quarto document, and its rendered version. In this case, we are rendering, the file into HTML. You can also knit to PDF or Word files and others.</p>
<p>Notice how the grey <strong>R code chunks</strong> are surrounded by 3 back-ticks and <code>{r LABEL}</code>. The first chunk, in this case <code>1+1</code>, is evaluated and return the output number (2). Notice the line in the second chunk that says <code>#| echo: false</code>? This is a code chunk option that indicates not to print the code. In the rendered version, we can see the outcome of <code>2*2</code> but not the executed code that created the outcome.</p>
<p>The table below show some of the options available to customizing outputs (<a href="https://quarto.org/docs/computations/execution-options.html">Quarto.org</a>).</p>
<table class="table">
<caption>Code chunk options</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>#| eval:</code></td>
<td>Evaluate the code chunk (if <code>false</code>, just echos the code into the output).</td>
</tr>
<tr class="even">
<td><code>#| echo:</code></td>
<td>Include the source code in output</td>
</tr>
<tr class="odd">
<td><code>#| warning:</code></td>
<td>Include warnings in the output.</td>
</tr>
<tr class="even">
<td><code>#| error:</code></td>
<td>Include warnings in the output.</td>
</tr>
<tr class="odd">
<td><code>#| include:</code></td>
<td>Catch all for preventing any output (code or results) from being included (e.g.<code>include: false</code> suppresses all output from the code block).</td>
</tr>
</tbody>
</table>
<p>Note that you can also combine these options by adding more than one to a code chunk.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>One important difference between Quarto documents and RMarkdown documents is that in Quarto, chunk options are written in special comment format (<code>#|</code>) at the top of code chunks rather than within the wiggly brackets next to ```<code>{r}</code> at the begging of the chunk. For example:</p>
<section id="quarto-code-options-syntax" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="quarto-code-options-syntax">Quarto code options syntax</h4>
<p><img src="images/quarto-code-options.png" class="img-fluid" style="width:60.0%"></p>
</section>
<section id="rmarkdown-code-options-syntax" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="rmarkdown-code-options-syntax">RMarkdown code options syntax</h4>
<p><img src="images/rmd-code-options.png" class="img-fluid" style="width:60.0%"></p>
</section>
</div>
</div>
<p>It is important to emphasize one more time that in an Quarto (and RMarkdown) document, the gray areas of the document are <em>code</em>, in this case R code because that is what it is indicated in the ```<code>{r}</code> syntax at the start of this gray area. And the white areas of a qmd are in markdown language.</p>
</section>
<section id="markdown-syntax" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="markdown-syntax"><span class="header-section-number">3.5</span> Markdown Syntax</h2>
<p>Let’s start by talking about markdown. <strong>Markdown is a formatting language for plain text</strong>, and there are only around 15 rules to know.</p>
<p>Notice the syntax in the document we just knitted:</p>
<ul>
<li><strong>Headers</strong> get rendered at multiple levels: <code>#</code>, <code>##</code></li>
<li><strong>Bold</strong>: <code>**word**</code></li>
</ul>
<p>There are some good <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Here-Cheatsheet">cheatsheets</a> to get you started, and here is one built into RStudio: Go to Help &gt; Markdown Quick Reference.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The hash symbol # is used differently in markdown and in R</strong></p>
<ul>
<li>In an R script or inside an R code chunk, a hash indicates a comment that will not be evaluated. You can use as many as you want: <code>#</code> is equivalent to <code>######</code>. It’s just a matter of style.</li>
<li>In markdown, a hash indicates a level of a header. And the number you use matters: <code>#</code> is a “level one header”, meaning the biggest font and the top of the hierarchy. <code>###</code> is a level three header, and will show up nested below the <code>#</code> and <code>##</code> headers.</li>
</ul>
<p><img src="images/rmarkdown_headers.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>In markdown, Write some italic text, make a numbered list, and add a few sub-headers. Use the Markdown Quick Reference (in the menu bar: Help &gt; Markdown Quick Reference).</li>
<li>Re-knit your html file and observe your edits.</li>
</ol>
</div>
</div>
</section>
<section id="the-visual-editor" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="the-visual-editor"><span class="header-section-number">3.6</span> The Visual Editor</h2>
<p>Quarto has a “what you see is what you mean” (WYSIWYM) editor or Visual editor, which can be a nice way to write markdown without remembering all of the markdown rules. Since there aren’t many rules for markdown, we recommend just learning them especially since markdown is used in many, many other contexts besides Quarto and RMarkdown. For example, formatting GitHub comments and README files.</p>
<p>To access the editor, click the Visual button in the upper left hand corner of your editor pane. You’ll notice that your document is now formatted as you type, and you can change elements of the formatting using the row of icons in the top of the editor pane. Although we don’t really recommend doing all of your markdown composition in the Visual editor, there are two features to this editor that we believe are <strong>immensely</strong> helpful, adding citations, and adding tables.</p>
<section id="adding-citations" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="adding-citations"><span class="header-section-number">3.6.1</span> Adding citations</h3>
<p>To add a citation, go to the visual editor and in the insert drop down, select “Citation.” In the window that appears, there are several options in the left hand panel for the source of your citation. If you have a citation manager, such as Zotero, installed, this would be included in that list. For now, select “From DOI”, and in the search bar enter a DOI of your choice (e.g.: 10.1038/s41467-020-17726-z), then select “Insert.”</p>
<p><img src="images/markdown-citation.png" class="img-fluid"></p>
<p>After selecting insert, a couple of things happen. First, the citation reference is inserted into your markdown text as <code>[@oke2020]</code>. Second, a file called references.bib containing the BibTex format of the citation is created. Third, that file is added to the YAML header of your Quarto document (<code>bibliography: references.bib</code>). Adding another citation will automatically update your <code>references.bib</code> file. So easy!</p>
</section>
<section id="adding-table-in-markdown" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="adding-table-in-markdown"><span class="header-section-number">3.6.2</span> Adding table in markdown</h3>
<p>The second task that the visual editor is convenient for is generating tables. Markdown tables are a bit finicky and annoying to type, and there are a number of formatting options that are difficult to remember if you don’t use them often. In the top icon bar, the “Table” drop down gives several options for inserting, editing, and formatting tables. Experiment with this menu to insert a small table.</p>
</section>
</section>
<section id="code-chunks-in-quarto" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="code-chunks-in-quarto"><span class="header-section-number">3.7</span> Code Chunks in Quarto</h2>
<p>Every time when opening a new Quarto document we should start by deleting all template text (everything except for the YAML). Then we save the document into the most convenient folder of our project. Now we are ready to start our work.</p>
<p>You can create a new chunk in your Quarto in one of these ways:</p>
<ul>
<li>Go to Code in the top menu bar, click “Insert Chunk”</li>
<li>Type by hand <code>{r}</code></li>
<li>Use the keyboard shortcut
<ul>
<li>Mac:<code>command</code> + <code>option</code> + <code>i</code></li>
<li>Windows: <code>Ctrl</code> + <code>Alt</code> + <code>i</code></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About code chunks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each code chunk needs to have an opening syntax ```<code>{r}</code> and a closing syntax ```. Everything in between these lines will be identified as R code.</p>
</div>
</div>
<p>If I want to write some R code, this is how it would look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">8</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>hights_ft <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">6.0</span>, <span class="fl">5.7</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fl">3.14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hitting return does not execute this command; remember, it’s just a text file. To execute it, we need to get what we typed in the the R chunk (the grey R code) down into the console. How do we do it? There are several ways (let’s do each of them):</p>
<ol type="1">
<li>Copy-paste this line into the console (generally not recommended as a primary method)</li>
<li>Select the line (or simply put the cursor there), and click “Run”. This is available from:
<ol type="a">
<li>the bar above the file (green arrow)</li>
<li>the menu bar: Code &gt; Run Selected Line(s)</li>
<li>keyboard shortcut: command-return</li>
</ol></li>
<li>Click the green arrow at the right of the code chunk</li>
</ol>
</section>
<section id="practice-literate-analysis-with-ocean-water-samples" class="level2 page-columns page-full" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="practice-literate-analysis-with-ocean-water-samples"><span class="header-section-number">3.8</span> Practice: Literate Analysis with ocean water samples</h2>
<p>Now that we have gone over the basics, let’s go a little deeper by building a simple, Quarto document that represents a literate analysis using real data. We are going to work with the seawater chemistry data. We are going to download a file named <code>BGchem2008data.csv</code> from the Arctic Data Center repository. Please follow the steps below to download the data and then upload to your RStudio Server <code>data</code> folder.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Navigate to the following dataset: <a href="https://doi.org/10.18739/A25T3FZ8X" class="uri">https://doi.org/10.18739/A25T3FZ8X</a></li>
<li>Download the file <code>BGchem2008data.csv</code></li>
<li>Click the “Upload” button in your RStudio server file browser.</li>
<li>In the dialog box, make sure the destination directory is the <code>data</code> directory in your R project, click “Choose File,” and locate the <code>BGchem2008data.csv</code> file. Press “OK” to upload the file.</li>
<li>Check your file was successfully uploaded by navigating into your <code>data</code> folder in the <strong>Files</strong> pane.</li>
</ul>
</div>
</div>
<section id="getting-started" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">3.8.1</span> Getting Started</h3>
<p>Experienced R users who have never used Quarto (or RMarkdown) often struggle a bit in the transition to developing analysis in Prose+Code format — which makes sense! It is switching the code paradigm to a new way of thinking.</p>
<p>Rather than starting an R chunk and putting all of your code in that single chunk, below we describe what we think is a better way.</p>
<ol type="1">
<li>Open a document and block out the high-level sections you know you’ll need to include using top level headers.</li>
<li>Add bullet points for some high level pseudo-code steps you know you’ll need to take.</li>
<li>Start filling in under each bullet point the code that accomplishes each step. As you write your code, transform your bullet points into prose, and add new bullet points or sections as needed.</li>
</ol>
<p>For this mini-analysis, we will have the following sections and code steps:</p>
<ol type="1">
<li>Introduction
<ol type="a">
<li>About the data</li>
<li>Setup</li>
<li>Read in data</li>
</ol></li>
<li>Analysis
<ol type="a">
<li>Calculate summary statistics</li>
<li>Calculate mean Redfield ratio</li>
<li>Plot Redfield ratio</li>
</ol></li>
<li>Conclusion</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Under “About the data”, write a sentence saying where the data set came from, including a hyperlink ti the data. Also mention when was the data downloaded.</p>
<p>Hint: Navigate to Help &gt; Markdown Quick Reference to look-up the hyperlink syntax.</p>
</div>
</div>
</section>
<section id="read-in-the-data" class="level3 page-columns page-full" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="read-in-the-data"><span class="header-section-number">3.8.2</span> Read in the data</h3>
<p>Now that we have outlined our document, we can start writing code! To read the data into our environment, we will use a function from the <code>readr</code> package.</p>
<p>To use a package in our analysis, we need to first make sure it is installed (you can install a package by running <code>install.package("name-of-package")</code>). Once installed you need to load it into our environment using <code>library(package_name)</code>. Even though we have installed it, we haven’t yet told our R session to access it. Because there are so many packages (many with conflicting namespaces) R cannot automatically load every single package you have installed. Instead, you load only the ones you need for a particular analysis. <strong>Loading the package is a key part of the <em>reproducible</em> aspect of our literate analysis</strong>, so we will include it as an R chunk as part of our Setup.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Best Practice
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is generally good practice to include all of your <code>library()</code> calls in a single, dedicated R chunk near the top of your document. This lets collaborators know what packages they might need to install before they start running your code.</p>
</div>
</div>
<p>The server should have already installed <code>readr</code>, so add a new R chunk below your Setup header that calls the <code>readr</code> library, and run it. It should look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, under “Read data”, add a code chunk that uses the <code>read_csv()</code> function to read in your data file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bg_chem <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/BGchem2008data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 70 Columns: 19
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (1): Station
dbl  (16): Latitude, Longitude, Target_Depth, CTD_Depth, CTD_Salinity, CTD_T...
dttm  (1): Time
date  (1): Date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Why <code>read_csv()</code> over <code>read.csv()</code>?</strong></p>
<p>We chose to show <code>read_csv()</code> from the <code>readr</code> package to introduce the concept of packages, to show you how to load packages, and <code>read_csv()</code> has several advantages over <code>read.csv()</code> from base R, including:</p>
<ul>
<li>More reasonable function defaults (no <code>stringsAsFactors</code>!)</li>
<li>Smarter column type parsing, especially for dates</li>
<li><code>read_csv()</code> is much faster than <code>read.csv()</code>, which is helpful for large files</li>
</ul>
</div></div><p>Once you run this line in your document, you should see the <code>bg_chem</code> object populate in your environment pane. It also spits out lots of text explaining what types the function parsed each column into. This text is important, and should be examined, but we might not want it in our final document.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>How would you suppress the warnings (so they don’t show in our output file) form a specific code chunk?</p>
<p><strong>Hint:</strong> Code chunk options</p>
</div>
</div>
</section>
<section id="calculate-summary-statistics" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="calculate-summary-statistics"><span class="header-section-number">3.8.3</span> Calculate Summary Statistics</h3>
<p>As our “analysis” we are going to calculate some very simple summary statistics and generate a single plot. Using water samples from the Arctic Ocean, we will examine the ratio of nitrogen to phosphate to see how closely the data match the Redfield ratio, which is the consistent 16:1 ratio of nitrogen to phosphorous atoms found in marine phytoplankton.</p>
<p>Let’s start by exploring the data we just read. Every time we read a new data set, it is important to familiarize yourself with it and make sure that the data looks as expected. Below some useful functions for exploring your data.</p>
<p>Let’s start by creating a new R chunk and run the following functions. Because this just an exploration and we do not want this chunk to be part of our report, we will indicate that by adding <code>#|eval: false</code> and <code>#| echo: false</code> in the setup of the chunk, that way, the code in this chunk will not run and not be displayed when I knit the final document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Prints the column names of my data frame</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bg_chem)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## General structure of the data frame - shows class of each column</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bg_chem)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## First 6 lines of the data frame</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bg_chem)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Summary of each column of data</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bg_chem)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Prints unique values in a column (in this case Date)</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bg_chem<span class="sc">$</span>Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To peek out data frame, we can type <code>View(bg_chem)</code> in the console. This will open a tab with our data frame in a tabular format.</p>
<p>Now that we know a more about the data set we are working with lets do some analyses. Under the appropriate bullet point in your analysis section, create a new R chunk, and use it to calculate the mean nitrate (NO3), nitrite (NO2), ammonium (NH4), and phosphorous (P) measured.</p>
<p>Save these mean values as new variables with easily understandable names, and write a (brief) description of your operation using markdown above the chunk. Remember that the <code>$</code> (aka the subset operator) indicates which column of your data to look into.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nitrate <span class="ot">&lt;-</span> <span class="fu">mean</span>(bg_chem<span class="sc">$</span>NO3)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nitrite <span class="ot">&lt;-</span> <span class="fu">mean</span>(bg_chem<span class="sc">$</span>NO2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>amm <span class="ot">&lt;-</span> <span class="fu">mean</span>(bg_chem<span class="sc">$</span>NH4)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>phos <span class="ot">&lt;-</span> <span class="fu">mean</span>(bg_chem<span class="sc">$</span>P)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In another chunk, use those variables to calculate the nitrogen: phosphate ratio (Redfield ratio).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> (nitrate <span class="sc">+</span> nitrite <span class="sc">+</span> amm)<span class="sc">/</span>phos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can access this variable in your markdown text by using R in-line in your text. The syntax to call R in-line (as opposed to as a chunk) is a single backtick `, followed by the letter “r”, then whatever your simple R command is — here we will use <code>round(ratio)</code> to print the calculated ratio, and finally a closing backtick `. This allows us to access the value stored in this variable in our explanatory text without resorting to the evaluate-copy-paste method so commonly used for this type of task.</p>
<p>So, the text in you Quarto document should look like this:</p>
<p>The Redfield ratio for this dataset is approximately: `r <code>round(ratio)</code>`</p>
<p>And the rendered text like this:</p>
<!-- need to change 6 back to 6-->
<p>The Redfield ratio for this dataset is approximately 6.</p>
<p>Finally, create a simple plot using base R that plots the ratio of the individual measurements, as opposed to looking at mean ratio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bg_chem<span class="sc">$</span>P, bg_chem<span class="sc">$</span>NO2 <span class="sc">+</span> bg_chem<span class="sc">$</span>NO3 <span class="sc">+</span> bg_chem<span class="sc">$</span>NH4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="session_03_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Decide whether or not you want the plotting code above to show up in your knitted document along with the plot, and implement your decision as a chunk option.</p>
<p>Render your Quarto document (by pressing the Render button) and observe the results.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How do I decide when to make a new code chunk?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Like many of life’s great questions, there is no clear cut answer. A rule of thumb is to have one chunk per functional unit of analysis. This functional unit could be 50 lines of code or it could be 1 line, but typically it only does one “thing.” This could be reading in data, making a plot, or defining a function. It could also mean calculating a series of related summary statistics (as we’ll see below). Ultimately, the choice is one related to personal preference and style, but generally you should ensure that code is divided up such that it is easily explainable in a literate analysis as the code is run.</p>
</div>
</div>
</section>
</section>
<section id="quarto-file-paths-and-environement" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="quarto-file-paths-and-environement"><span class="header-section-number">3.9</span> Quarto file paths and environement</h2>
<p>As we discussed during our setup session, in computing, a path specifies the unique location of a file on the filesystem. A path can come in one of two forms: absolute or relative.</p>
<ul>
<li><strong>Absolute paths</strong> start at the very top of your file system, and work their way down the directory tree to the file.</li>
<li><strong>Relative paths</strong> start at an arbitrary point in the file system. In R, this point is set by your working directory.</li>
</ul>
<p>Quarto has a special way of handling relative paths that can be very handy. When working in an Quarto document, <strong>R will set all paths relative to the location of the Quarto file</strong>. This way, you don’t have to worry about setting a working directory, or changing your colleagues absolute path structure with the correct user name, etc. If your Quarto document is stored near where the data it analyses are stored (good practice, generally), setting paths becomes much easier!</p>
<p>If you saved your <code>BGchem2008data.csv</code> data file in the same location as your qmd, you can just write <code>read_csv("BGchem2008data.csv")</code> to read it in. Checkout the help page by typing <code>?read_csv()</code> in the console. This tells you that for this function the first argument should be a pointer to the file. Rstudio has some nice helpers to help you navigate paths. If you open quotes and press <code>tab</code> with your cursor between the quotes, a popup menu will appear showing you some options.</p>
<section id="practice-quarto-and-environments" class="level3" data-number="3.9.1">
<h3 data-number="3.9.1" class="anchored" data-anchor-id="practice-quarto-and-environments"><span class="header-section-number">3.9.1</span> Practice: Quarto and Environments</h3>
<p>Let’s walk through an exercise with the document we just created to demonstrate how Quarto handles environments. We will be deliberately inducing some errors here for demonstration purposes.</p>
<p>First, follow these steps:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Restart your R session (Session &gt; Restart R)</li>
<li>Run the last chunk in your Quarto document by pressing the play button on the chunk</li>
</ul>
</div>
</div>
<p>Perhaps not surprisingly, we get an error:</p>
<pre><code>Error in plot(bg_chem$P, bg_chem$NO2 + bg_chem$NO3 + bg_chem$NH4) : 
  object 'bg_chem' not found</code></pre>
<p>This is because we have not run the chunk of code that reads in the <code>bg_chem</code> data. The R part of Quarto works just like a regular R script. You have to execute the code, and the order that you run it in matters. It is relatively easy to get mixed up in a large Quarto document — running chunks out of order, or forgetting to run chunks.</p>
<p>To resolve this, follow the next step:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup continued
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Select from the “Run” menu (top right of the editor pane) “Run All.”</li>
<li>Observe the <code>bg_chem</code> variable in your environment</li>
</ul>
</div>
</div>
<p>This is a great way to reset and re-run code when things seem to have gone sideways. It is great practice to do periodically since it helps ensure you are writing code that actually runs and it’s reproducible.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For the next exercise:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Clean your environment by clicking the broom in the environment pane</li>
<li>Restart your R session (Session &gt; Restart R)</li>
<li>Press “Render” to run all of the code in your document</li>
<li>Observe the state of your environment pane</li>
</ul>
<p>Assuming your document rendered and produced an html page, your code ran. Yet, the environment pane is empty. What happened?</p>
</div>
</div>
<p>The Render button is rather special — it doesn’t just run all of the code in your document. It actually spins up a fresh R environment separate from the one you have been working in, runs all of the code in your document, generates the output, and then closes the environment. This is one of the best ways Quarto (or RMarkdown) helps ensure you have built a reproducible workflow. If, while you were developing your code, you ran a line in the console as opposed to adding it to your Quarto document, the code you develop while working actively in your environment will still work. However, when you knit your document, the environment RStudio spins up doesn’t know anything about that working environment you were in. Thus, your code may error because it doesn’t have that extra piece of information. Commonly, <code>library()</code> calls are the source of this kind of frustration when the author runs it in the console, but forgets to add it to the script.</p>
<p>To further clarify the point on environments, perform the following steps:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup continued
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Select from the “Run” menu (top right of editor pane) “Run All”</li>
<li>Observe all of the variables in your environment</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What about all my R Scripts?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some pieces of R code are better suited for R scripts than Quarto or RMarkdown. A function you wrote yourself that you use in many different analyses is probably better to define in an R script than repeated across many Quarto or RMarkdown documents. Some analyses have mundane or repetitive tasks that don’t need to be explained very much. For example, in the document shown in the beginning of this lesson, 15 different excel files needed to be reformatted in slightly different, mundane ways, like renaming columns and removing header text. Instead of including these tasks in the primary Quarto document, the authors chose to write one R script per file and stored them all in a directory. Then, took the contents of one script and included it in the literate analysis, using it as an example to explain what the scripts did, and then used the <code>source()</code> function to run them all from within the Quarto document.</p>
<p>So, just because you know Quarto now, doesn’t mean you won’t be using R scripts anymore. Both <code>.R</code> and <code>.qmd</code> have their roles to play in analysis. With practice, it will become more clear what works well in Quarto or RMarkdown, and what belongs in a regular R script.</p>
</div>
</div>
</section>
</section>
<section id="additional-quarto-resources" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="additional-quarto-resources"><span class="header-section-number">3.10</span> Additional Quarto Resources</h2>
<ul>
<li>Posit (the organization that developed Quarto) has great documentation, check out <a href="quarto.org">Quarto.org</a></li>
<li>R for Data Science (2e) (Wickham et al, 2023), this is an awesome book for all R related things. Chapter <a href="https://r4ds.hadley.nz/quarto.html">29 and 30</a> are specific to Quarto.</li>
</ul>

<!--## Troubleshooting: My RMarkdown Won't Knit to PDF

If you get an error when trying to knit to PDF that says your computer
doesn't have a LaTeX installation, one of two things is likely
happening:

-   Your computer doesn't have LaTeX installed
-   You have an installation of LaTeX but RStudio cannot find it (it is
    not on the path)

If you already use LaTeX (like to write papers), you fall in the second
category. Solving this requires directing RStudio to your installation -
and isn't covered here.

If you fall in the first category - you are sure you don't have LaTeX
installed - can use the R package `tinytex` to easily get an
installation recognized by RStudio, as long as you have administrative
rights to your computer.

To install `tinytex` run:

::: {.cell}

```{.r .cell-code}
install.packages("tinytex")
tinytex::install_tinytex()
```
:::

If you get an error that looks like destination /usr/local/bin not
writable, you need to give yourself permission to write to this
directory (again, only possible if you have administrative rights). To
do this, run this command in the terminal:

``` bash
sudo chown -R `whoami`:admin /usr/local/bin
```

and then try the above install instructions again. Learn more about
`tinytex` from [Yihui Xie's online book
*TinyTeX*](https://yihui.org/tinytex/). -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./session_02.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><code>Git</code> and GitHub Setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./session_04.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">LEGO® Reproducibility Activity</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>