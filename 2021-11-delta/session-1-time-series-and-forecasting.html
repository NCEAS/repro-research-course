<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Session 1: Time Series and Forecasting | Open Science Synthesis for the Delta Science Program: Week 3</title>
  <meta name="description" content="1 Session 1: Time Series and Forecasting | Open Science Synthesis for the Delta Science Program: Week 3" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Session 1: Time Series and Forecasting | Open Science Synthesis for the Delta Science Program: Week 3" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Session 1: Time Series and Forecasting | Open Science Synthesis for the Delta Science Program: Week 3" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="session-2-web-based-data-archival.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Open Science Synthesis for the Delta Science Program: Week 3</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>0.1</b> Schedule</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1.1</b> Code of Conduct</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>0.1.2</b> About this book</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html"><i class="fa fa-check"></i><b>1</b> Session 1: Time Series and Forecasting</a>
<ul>
<li class="chapter" data-level="1.1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#linear-regression-with-time-as-a-predictor"><i class="fa fa-check"></i><b>1.2</b> Linear regression, with time as a predictor</a></li>
<li class="chapter" data-level="1.3" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#time-series-feature-extraction"><i class="fa fa-check"></i><b>1.3</b> Time series ‘feature extraction’</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#the-predict-function-forecasting-with-a-fitted-regression-model"><i class="fa fa-check"></i><b>1.3.1</b> The ‘predict’ function: forecasting with a fitted regression model</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#time-series-objects-in-r"><i class="fa fa-check"></i><b>1.4</b> Time Series objects in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#autocorrelation-plots"><i class="fa fa-check"></i><b>1.4.1</b> Autocorrelation plots</a></li>
<li class="chapter" data-level="1.4.2" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#seasonal-trend-with-loess-smoothing-stl-decomposition"><i class="fa fa-check"></i><b>1.4.2</b> Seasonal Trend with Loess smoothing (STL) decomposition</a></li>
<li class="chapter" data-level="1.4.3" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#now-we-can-analyze-the-trend"><i class="fa fa-check"></i><b>1.4.3</b> Now we can analyze the trend</a></li>
<li class="chapter" data-level="1.4.4" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#some-time-series-model-acronyms"><i class="fa fa-check"></i><b>1.4.4</b> Some Time Series Model Acronyms</a></li>
<li class="chapter" data-level="1.4.5" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#state-space-models"><i class="fa fa-check"></i><b>1.4.5</b> State Space Models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#ecological-forecasting"><i class="fa fa-check"></i><b>1.5</b> Ecological Forecasting</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#forecasting-challenges"><i class="fa fa-check"></i><b>1.5.1</b> Forecasting Challenges</a></li>
<li class="chapter" data-level="1.5.2" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#the-forecasting-toolbox"><i class="fa fa-check"></i><b>1.5.2</b> The forecasting toolbox</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#your-turn---some-actual-data"><i class="fa fa-check"></i><b>1.6</b> Your Turn - Some Actual Data!</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#example-1-a-twenty-year-history-of-weather-in-maricopa-az"><i class="fa fa-check"></i><b>1.6.1</b> Example 1: A twenty year history of weather in Maricopa, AZ</a></li>
<li class="chapter" data-level="1.6.2" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#autocorrelation"><i class="fa fa-check"></i><b>1.6.2</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#growth-curves"><i class="fa fa-check"></i><b>1.7</b> Growth Curves</a></li>
<li class="chapter" data-level="1.8" data-path="session-1-time-series-and-forecasting.html"><a href="session-1-time-series-and-forecasting.html#references"><i class="fa fa-check"></i><b>1.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html"><i class="fa fa-check"></i><b>2</b> Session 2: Web based data archival</a>
<ul>
<li class="chapter" data-level="2.1" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#best-practices-data-and-metadata"><i class="fa fa-check"></i><b>2.1</b> Best Practices: Data and Metadata</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.1.2" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#best-practices-overview"><i class="fa fa-check"></i><b>2.1.2</b> Best Practices: Overview</a></li>
<li class="chapter" data-level="2.1.3" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#data-identifiers"><i class="fa fa-check"></i><b>2.1.3</b> Data Identifiers</a></li>
<li class="chapter" data-level="2.1.4" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#data-citation"><i class="fa fa-check"></i><b>2.1.4</b> Data Citation</a></li>
<li class="chapter" data-level="2.1.5" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#provanance-preserving-computational-workflows"><i class="fa fa-check"></i><b>2.1.5</b> Provanance &amp; Preserving Computational Workflows</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#data-documentation-and-publishing"><i class="fa fa-check"></i><b>2.2</b> Data Documentation and Publishing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#learning-objectives-2"><i class="fa fa-check"></i><b>2.2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2.2" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#data-sharing-and-preservation"><i class="fa fa-check"></i><b>2.2.2</b> Data sharing and preservation</a></li>
<li class="chapter" data-level="2.2.3" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#data-repositories-built-for-data-and-code"><i class="fa fa-check"></i><b>2.2.3</b> Data repositories: built for data (and code)</a></li>
<li class="chapter" data-level="2.2.4" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#metadata"><i class="fa fa-check"></i><b>2.2.4</b> Metadata</a></li>
<li class="chapter" data-level="2.2.5" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#structure-of-a-data-package"><i class="fa fa-check"></i><b>2.2.5</b> Structure of a data package</a></li>
<li class="chapter" data-level="2.2.6" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#dataone-federation"><i class="fa fa-check"></i><b>2.2.6</b> DataONE Federation</a></li>
<li class="chapter" data-level="" data-path="session-2-web-based-data-archival.html"><a href="session-2-web-based-data-archival.html#publishing-data-from-the-web"><i class="fa fa-check"></i>Publishing data from the web</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html"><i class="fa fa-check"></i><b>3</b> Session 3: Programmatic metadata and data access</a>
<ul>
<li class="chapter" data-level="3.1" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#reproducible-data-access"><i class="fa fa-check"></i><b>3.1</b> Reproducible Data Access</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#learning-objectives-3"><i class="fa fa-check"></i><b>3.1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.1.2" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#barriers-to-data-access"><i class="fa fa-check"></i><b>3.1.2</b> Barriers to data access</a></li>
<li class="chapter" data-level="3.1.3" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#persistent-and-portable-data-access-for-improving-reproducibility"><i class="fa fa-check"></i><b>3.1.3</b> Persistent and portable data access for improving reproducibility</a></li>
<li class="chapter" data-level="3.1.4" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#storing-a-content-identifier-from-a-uri"><i class="fa fa-check"></i><b>3.1.4</b> Storing a content identifier from a URI</a></li>
<li class="chapter" data-level="3.1.5" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#loading-data-from-a-content-identifier"><i class="fa fa-check"></i><b>3.1.5</b> Loading data from a content identifier</a></li>
<li class="chapter" data-level="3.1.6" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#storing-and-using-local-data-identifiers"><i class="fa fa-check"></i><b>3.1.6</b> Storing and using local data identifiers</a></li>
<li class="chapter" data-level="3.1.7" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#improvements-to-content-identifiers"><i class="fa fa-check"></i><b>3.1.7</b> Improvements to content identifiers</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#programming-metadata-and-data-publishing"><i class="fa fa-check"></i><b>3.2</b> Programming Metadata and Data Publishing</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#learning-objectives-4"><i class="fa fa-check"></i><b>3.2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2.2" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#creating-metadata"><i class="fa fa-check"></i><b>3.2.2</b> Creating Metadata</a></li>
<li class="chapter" data-level="3.2.3" data-path="session-3-programmatic-metadata-and-data-access.html"><a href="session-3-programmatic-metadata-and-data-access.html#publish-data-to-the-arctic-data-center-test-site"><i class="fa fa-check"></i><b>3.2.3</b> Publish data to the Arctic Data Center test site</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html"><i class="fa fa-check"></i><b>4</b> Session 4: Model Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#learning-objectives-5"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#comparing-models-to-data"><i class="fa fa-check"></i><b>4.2</b> Comparing models to data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#statistical-tests-of-model-performance"><i class="fa fa-check"></i><b>4.2.1</b> Statistical tests of model performance</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#simulation-models"><i class="fa fa-check"></i><b>4.3</b> Simulation Models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#example-a-leaf-level-model-of-photosynthesis"><i class="fa fa-check"></i><b>4.3.1</b> Example: A leaf level model of photosynthesis</a></li>
<li class="chapter" data-level="4.3.2" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#lets-run-this-model"><i class="fa fa-check"></i><b>4.3.2</b> Let’s run this model!</a></li>
<li class="chapter" data-level="4.3.3" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#variance-decomposition---which-of-these-parameters-are-most-important"><i class="fa fa-check"></i><b>4.3.3</b> Variance Decomposition - which of these parameters are most important?</a></li>
<li class="chapter" data-level="4.3.4" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#propagate-met-and-use-met-as-a-variable-sample-over-variation-within-the-hour"><i class="fa fa-check"></i><b>4.3.4</b> Propagate met and Use met as a variable, sample over variation within the hour</a></li>
<li class="chapter" data-level="4.3.5" data-path="session-4-model-analysis.html"><a href="session-4-model-analysis.html#references-1"><i class="fa fa-check"></i><b>4.3.5</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="session-5-shiny.html"><a href="session-5-shiny.html"><i class="fa fa-check"></i><b>5</b> Session 5: Shiny</a>
<ul>
<li class="chapter" data-level="5.1" data-path="session-5-shiny.html"><a href="session-5-shiny.html#introduction-to-shiny"><i class="fa fa-check"></i><b>5.1</b> Introduction to Shiny</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="session-5-shiny.html"><a href="session-5-shiny.html#learning-objectives-6"><i class="fa fa-check"></i><b>5.1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.1.2" data-path="session-5-shiny.html"><a href="session-5-shiny.html#overview"><i class="fa fa-check"></i><b>5.1.2</b> Overview</a></li>
<li class="chapter" data-level="5.1.3" data-path="session-5-shiny.html"><a href="session-5-shiny.html#create-a-sample-shiny-application"><i class="fa fa-check"></i><b>5.1.3</b> Create a sample shiny application</a></li>
<li class="chapter" data-level="5.1.4" data-path="session-5-shiny.html"><a href="session-5-shiny.html#shiny-architecture"><i class="fa fa-check"></i><b>5.1.4</b> Shiny architecture</a></li>
<li class="chapter" data-level="5.1.5" data-path="session-5-shiny.html"><a href="session-5-shiny.html#interactive-scatterplots"><i class="fa fa-check"></i><b>5.1.5</b> Interactive scatterplots</a></li>
<li class="chapter" data-level="5.1.6" data-path="session-5-shiny.html"><a href="session-5-shiny.html#extending-the-user-interface-with-dynamic-plots"><i class="fa fa-check"></i><b>5.1.6</b> Extending the user interface with dynamic plots</a></li>
<li class="chapter" data-level="5.1.7" data-path="session-5-shiny.html"><a href="session-5-shiny.html#finishing-touches-data-citation"><i class="fa fa-check"></i><b>5.1.7</b> Finishing touches: data citation</a></li>
<li class="chapter" data-level="5.1.8" data-path="session-5-shiny.html"><a href="session-5-shiny.html#publishing-shiny-applications"><i class="fa fa-check"></i><b>5.1.8</b> Publishing Shiny applications</a></li>
<li class="chapter" data-level="5.1.9" data-path="session-5-shiny.html"><a href="session-5-shiny.html#summary"><i class="fa fa-check"></i><b>5.1.9</b> Summary</a></li>
<li class="chapter" data-level="5.1.10" data-path="session-5-shiny.html"><a href="session-5-shiny.html#full-source-code-for-the-final-application"><i class="fa fa-check"></i><b>5.1.10</b> Full source code for the final application</a></li>
<li class="chapter" data-level="5.1.11" data-path="session-5-shiny.html"><a href="session-5-shiny.html#a-shinier-app-with-tabs-and-a-map"><i class="fa fa-check"></i><b>5.1.11</b> A shinier app with tabs and a map!</a></li>
<li class="chapter" data-level="5.1.12" data-path="session-5-shiny.html"><a href="session-5-shiny.html#resources"><i class="fa fa-check"></i><b>5.1.12</b> Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html"><i class="fa fa-check"></i><b>6</b> Session 6: Reproducible workflows revisited</a>
<ul>
<li class="chapter" data-level="6.1" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#workflows-and-continuous-integration"><i class="fa fa-check"></i><b>6.1</b> Workflows and Continuous Integration</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#learning-outcomes"><i class="fa fa-check"></i><b>6.1.1</b> Learning Outcomes</a></li>
<li class="chapter" data-level="6.1.2" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#introduction"><i class="fa fa-check"></i><b>6.1.2</b> Introduction</a></li>
<li class="chapter" data-level="6.1.3" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#workflow-dependencies-and-encapsulation"><i class="fa fa-check"></i><b>6.1.3</b> Workflow dependencies and encapsulation</a></li>
<li class="chapter" data-level="" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#dependencies"><i class="fa fa-check"></i>Dependencies</a></li>
<li class="chapter" data-level="6.1.4" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#benefits"><i class="fa fa-check"></i><b>6.1.4</b> Benefits</a></li>
<li class="chapter" data-level="6.1.5" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#organizing-code-in-packages"><i class="fa fa-check"></i><b>6.1.5</b> Organizing code in packages</a></li>
<li class="chapter" data-level="6.1.6" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#workflow-systems"><i class="fa fa-check"></i><b>6.1.6</b> Workflow systems</a></li>
<li class="chapter" data-level="6.1.7" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#exercise"><i class="fa fa-check"></i><b>6.1.7</b> Exercise</a></li>
<li class="chapter" data-level="6.1.8" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#readings-and-tutorials"><i class="fa fa-check"></i><b>6.1.8</b> Readings and tutorials</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#parallel-computing-in-r"><i class="fa fa-check"></i><b>6.2</b> Parallel Computing in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#learning-outcomes-1"><i class="fa fa-check"></i><b>6.2.1</b> Learning Outcomes</a></li>
<li class="chapter" data-level="6.2.2" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#introduction-1"><i class="fa fa-check"></i><b>6.2.2</b> Introduction</a></li>
<li class="chapter" data-level="6.2.3" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#why-parallelism"><i class="fa fa-check"></i><b>6.2.3</b> Why parallelism?</a></li>
<li class="chapter" data-level="6.2.4" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#processors-cpus-and-cores"><i class="fa fa-check"></i><b>6.2.4</b> Processors (CPUs) and Cores</a></li>
<li class="chapter" data-level="6.2.5" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#when-to-parallelize"><i class="fa fa-check"></i><b>6.2.5</b> When to parallelize</a></li>
<li class="chapter" data-level="6.2.6" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#loops-and-repetitive-tasks-using-lapply"><i class="fa fa-check"></i><b>6.2.6</b> Loops and repetitive tasks using lapply</a></li>
<li class="chapter" data-level="6.2.7" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#approaches-to-parallelization"><i class="fa fa-check"></i><b>6.2.7</b> Approaches to parallelization</a></li>
<li class="chapter" data-level="6.2.8" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#parallelize-using-mclapply"><i class="fa fa-check"></i><b>6.2.8</b> Parallelize using: mclapply</a></li>
<li class="chapter" data-level="6.2.9" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#parallelize-using-foreach-and-doparallel"><i class="fa fa-check"></i><b>6.2.9</b> Parallelize using: foreach and doParallel</a></li>
<li class="chapter" data-level="6.2.10" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#summary-1"><i class="fa fa-check"></i><b>6.2.10</b> Summary</a></li>
<li class="chapter" data-level="6.2.11" data-path="session-6-reproducible-workflows-revisited.html"><a href="session-6-reproducible-workflows-revisited.html#readings-and-tutorials-1"><i class="fa fa-check"></i><b>6.2.11</b> Readings and tutorials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html"><i class="fa fa-check"></i><b>7</b> Session 7: Communicating Your Research: The Message Box</a>
<ul>
<li class="chapter" data-level="7.1" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html#communication-principles-and-practices"><i class="fa fa-check"></i><b>7.1</b> Communication Principles and Practices</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html#scholarly-publications"><i class="fa fa-check"></i><b>7.1.1</b> Scholarly publications</a></li>
<li class="chapter" data-level="7.1.2" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html#other-communications"><i class="fa fa-check"></i><b>7.1.2</b> Other communications</a></li>
<li class="chapter" data-level="7.1.3" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html#the-message-box"><i class="fa fa-check"></i><b>7.1.3</b> The Message Box</a></li>
<li class="chapter" data-level="7.1.4" data-path="session-7-communicating-your-research-the-message-box.html"><a href="session-7-communicating-your-research-the-message-box.html#resources-1"><i class="fa fa-check"></i><b>7.1.4</b> Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="session-8-wrap-up.html"><a href="session-8-wrap-up.html"><i class="fa fa-check"></i><b>8</b> Session 8: Wrap Up</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="session-8-wrap-up.html"><a href="session-8-wrap-up.html#material-to-include"><i class="fa fa-check"></i><b>8.0.1</b> Material to include:</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Open Science Synthesis for the Delta Science Program: Week 3</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session-1-time-series-and-forecasting" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Session 1: Time Series and Forecasting</h1>
<div id="learning-objectives" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Learning Objectives</h2>
<p>These lessons are the equivalent of a city bus tour. They are a high level tour of some useful functions.</p>
<p>There are plenty of more detailed lessons on the internet. I would recommend starting with the <a href="https://otexts.com/fpp2/">“Forecasting Principles and Practice v2”</a> by Rob Hyndman who wrote the forecast package.</p>
<p>Today we will take a tour with the <code>predict</code> function in R, as well as some advanced time series statistics that are provided by the forecast package.</p>
<p>In this session you will learn how to</p>
<ul>
<li>Simulate data and test if your model is working as expected</li>
<li>Use linear regression to fit and predict time series</li>
<li>Visualize data</li>
<li>Decompose a time series into seasonal, trend, and error</li>
</ul>
<p><em>a note on the forecast package</em> Hydnman and others are creating the successor to the forecast package called ‘feasts.’ The next version of the text uses this package <a href="https://otexts.com/fpp3/" class="uri">https://otexts.com/fpp3/</a>.</p>
</div>
<div id="linear-regression-with-time-as-a-predictor" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Linear regression, with time as a predictor</h2>
<p>Both the simulation of data and the fitting of the model here is a general approach. It is demonstrated with a simple regression model of increasing <span class="math inline">\(Y\)</span> as a funciton of time. But simulating data can be very useful in understanding your data, your model, and the about statistics in general.</p>
<p>First, lets define our data model.</p>
<p>We want to fit. simulate a time series of one observations on each of ten subsequent dates:</p>
<p>Our data model is effectively</p>
<p><span class="math display">\[
Y_{\textrm{linear}}=1+2t +\epsilon\\
\epsilon\sim N(0,1)
\]</span>
Where y is the mass of your favorite organism. They are born on day 0 with 1 g and growth on average is 2 grams per day.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="session-1-time-series-and-forecasting.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-2"><a href="session-1-time-series-and-forecasting.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="session-1-time-series-and-forecasting.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="session-1-time-series-and-forecasting.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-5"><a href="session-1-time-series-and-forecasting.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">103</span>)</span>
<span id="cb1-6"><a href="session-1-time-series-and-forecasting.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="session-1-time-series-and-forecasting.html#cb1-7" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb1-8"><a href="session-1-time-series-and-forecasting.html#cb1-8" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb1-9"><a href="session-1-time-series-and-forecasting.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="fu">seq_along</span>(days)){</span>
<span id="cb1-10"><a href="session-1-time-series-and-forecasting.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  mass[t] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> days[t] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-11"><a href="session-1-time-series-and-forecasting.html#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="session-1-time-series-and-forecasting.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="session-1-time-series-and-forecasting.html#cb1-13" aria-hidden="true" tabindex="-1"></a>linear_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">day =</span> days, <span class="at">mass =</span> mass)</span>
<span id="cb1-14"><a href="session-1-time-series-and-forecasting.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mass<span class="sc">~</span>day, </span>
<span id="cb1-15"><a href="session-1-time-series-and-forecasting.html#cb1-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> linear_data, </span>
<span id="cb1-16"><a href="session-1-time-series-and-forecasting.html#cb1-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;mass (g)&#39;</span>, </span>
<span id="cb1-17"><a href="session-1-time-series-and-forecasting.html#cb1-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>),</span>
<span id="cb1-18"><a href="session-1-time-series-and-forecasting.html#cb1-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Now, we can fit a linear regression, and estimate the parameters. Did the model find the ‘right’ values?</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="session-1-time-series-and-forecasting.html#cb2-1" aria-hidden="true" tabindex="-1"></a>mod_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days, <span class="at">data =</span> linear_data)</span>
<span id="cb2-2"><a href="session-1-time-series-and-forecasting.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_linear)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic      p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1 (Intercept)    0.316     0.560     0.565 0.588       
## 2 days           2.07      0.105    19.8   0.0000000447</code></pre>
<p>Did we recover the correct parameters from the simulated data?</p>
<p>Don’t forget to check assumptions! <code>plot(lm)</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="session-1-time-series-and-forecasting.html#cb4-1" aria-hidden="true" tabindex="-1"></a>mod_linear</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ 1 + days, data = linear_data)
## 
## Coefficients:
## (Intercept)         days  
##       0.316        2.074</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="session-1-time-series-and-forecasting.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## you can look at model statistics </span></span>
<span id="cb6-2"><a href="session-1-time-series-and-forecasting.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_linear)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ 1 + days, data = linear_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4773 -0.5670  0.0455  0.5720  1.3558 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.316      0.560    0.56     0.59    
## days           2.074      0.105   19.77  4.5e-08 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.953 on 8 degrees of freedom
## Multiple R-squared:  0.98,   Adjusted R-squared:  0.977 
## F-statistic:  391 on 1 and 8 DF,  p-value: 4.47e-08</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="session-1-time-series-and-forecasting.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## don&#39;t forget to check assumptions, etc</span></span>
<span id="cb8-2"><a href="session-1-time-series-and-forecasting.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">## this is helpful even when you simulate and you know</span></span>
<span id="cb8-3"><a href="session-1-time-series-and-forecasting.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## that the data generating process is valid; get an idea of what is &#39;okay&#39;</span></span>
<span id="cb8-4"><a href="session-1-time-series-and-forecasting.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="session-1-time-series-and-forecasting.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod_linear)</span></span></code></pre></div>
</div>
<div id="time-series-feature-extraction" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Time series ‘feature extraction’</h2>
<p>We’ve already extracted features from our time series. What are ‘features?’ These are
properties underlying the data. In this case, the information in our time series has been condensed into a slope and intercept.</p>
<p>There are a lot of other mathematical functions that can be fit to your data, and properties of these functions that can be extracted, and used in subsequent analyses.</p>
<p>Bolker (2007) provides a ‘bestiary of functions’ in chapter 3 of his book <a href="https://ms.mcmaster.ca/~bolker/emdbook/book.pdf">“Ecological Models and Data in R”</a>. It provides some biological meanings and useful contexts for a variety of linear and non-linear, continuous and discontinuous functions.</p>
<p>This is a common and very useful way of converting a time series into features.</p>
<p>For an example of Bayesian logistic regression using JAGS, see the work done by Jessica Guo and me: <a href="https://github.com/genophenoenvo/JAGS-logistic-growth" class="uri">https://github.com/genophenoenvo/JAGS-logistic-growth</a>.</p>
<p>Dietze’s Ecological forecasting course shows how to simulate a logistic growth curve using Monte Carlo methods. <a href="https://github.com/EcoForecast/EF_Activities/blob/master/Exercise_02_Logistic.Rmd" class="uri">https://github.com/EcoForecast/EF_Activities/blob/master/Exercise_02_Logistic.Rmd</a></p>
<p>There are a huge number of other methods for ‘dimensionality reduction.’ Principal components analysis is an important one. Another is taking a full resolution image and reducing the resolution to a few pixels square, and everything in between. In the ‘machine learning’ world a wide range of methods are used in a process that they call ‘encoding’ .</p>
<div id="the-predict-function-forecasting-with-a-fitted-regression-model" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> The ‘predict’ function: forecasting with a fitted regression model</h3>
<p>The <code>predict</code> function in R has a variety of uses. Last week we learned how to use it to impute missing data values. This week, we will learn how to use it to predict the next time points in our time series.</p>
<p>First step, lets predict what is the <em>expected</em> value on the subsequent few days.
This is using the fitted slope and intercept to plot a single value on the regression line for each day.</p>
<p>We will plot the data in black, the new points in red, and the regression line.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="session-1-time-series-and-forecasting.html#cb9-1" aria-hidden="true" tabindex="-1"></a>newdays <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb9-2"><a href="session-1-time-series-and-forecasting.html#cb9-2" aria-hidden="true" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">days =</span> newdays)</span>
<span id="cb9-3"><a href="session-1-time-series-and-forecasting.html#cb9-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_linear, </span>
<span id="cb9-4"><a href="session-1-time-series-and-forecasting.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">newdata =</span> newdat)</span>
<span id="cb9-5"><a href="session-1-time-series-and-forecasting.html#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="session-1-time-series-and-forecasting.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mass <span class="sc">~</span> day, </span>
<span id="cb9-7"><a href="session-1-time-series-and-forecasting.html#cb9-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> linear_data, </span>
<span id="cb9-8"><a href="session-1-time-series-and-forecasting.html#cb9-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;mass (g)&#39;</span>, </span>
<span id="cb9-9"><a href="session-1-time-series-and-forecasting.html#cb9-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>),</span>
<span id="cb9-10"><a href="session-1-time-series-and-forecasting.html#cb9-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="session-1-time-series-and-forecasting.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(newdays, preds, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="session-1-time-series-and-forecasting.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">coef</span>(mod_linear)) <span class="sc">+</span> </span>
<span id="cb9-13"><a href="session-1-time-series-and-forecasting.html#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">confint</span>(mod_linear)[,<span class="dv">1</span>], <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="session-1-time-series-and-forecasting.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">confint</span>(mod_linear)[,<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<p>Now, we have predicted the next five days of growth!</p>
</div>
</div>
<div id="time-series-objects-in-r" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Time Series objects in R</h2>
<p>R has a specific type of time series ‘object.’ that is analogous to a ‘data.frame,’ but special. It is called a time series object - ‘ts’ (or ‘mts’ for a multivariate time series). See <code>?ts</code></p>
<p>Lets create time series objects so that we can use some of the basic functions for time series analysis.</p>
<p>How to make a time series object.</p>
<p>Last week when we learned about the <code>imputeTS</code> package, we skipped over what we actually did to make a time series object.</p>
<p>We set the start and end by year and index, and then either a time step ‘deltat’ or frequency.</p>
<p>Values of frequency (per year):
- daily data: 365
- monthly: 12
- hourly: 365*24
- etc</p>
<p>Lets make some sample monthly time series for three cases</p>
<ol style="list-style-type: decimal">
<li>for white noise: <span class="math inline">\(Y=\epsilon\)</span></li>
<li>with autocorrelation with a 1 month lag <span class="math inline">\(Y_t=\frac{Y_{t-1}+Y_{t}}{2}\)</span></li>
<li>with autocorrelation and a trend <span class="math inline">\(Y_t=\frac{Y_{t-1}+Y_{t}}{2} + \frac{t}{48}+\epsilon\)</span></li>
<li>with seasonal patterns <span class="math inline">\(Y_t=\sin(\frac{2\pi t}{12})+\epsilon\)</span></li>
<li>with seasonal patterns and a trend <span class="math inline">\(Y_t=\sin(\frac{2\pi t}{12})+\frac{t}{48} + \epsilon\)</span></li>
</ol>
<p>Where <span class="math inline">\(t\)</span> is the time step (in units of months). The second equation takes the average of the last time step and the current one (a moving window of size 2). The third equation adds a trend - every month the value increases by 1/120.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="session-1-time-series-and-forecasting.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">210</span>)</span>
<span id="cb11-2"><a href="session-1-time-series-and-forecasting.html#cb11-2" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">240</span></span>
<span id="cb11-3"><a href="session-1-time-series-and-forecasting.html#cb11-3" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(months))</span>
<span id="cb11-4"><a href="session-1-time-series-and-forecasting.html#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="session-1-time-series-and-forecasting.html#cb11-5" aria-hidden="true" tabindex="-1"></a>lag   <span class="ot">&lt;-</span> <span class="fu">vector</span>() </span>
<span id="cb11-6"><a href="session-1-time-series-and-forecasting.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(months)){</span>
<span id="cb11-7"><a href="session-1-time-series-and-forecasting.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(t <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb11-8"><a href="session-1-time-series-and-forecasting.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    lag[t]  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb11-9"><a href="session-1-time-series-and-forecasting.html#cb11-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-10"><a href="session-1-time-series-and-forecasting.html#cb11-10" aria-hidden="true" tabindex="-1"></a>    lag[t]  <span class="ot">&lt;-</span> (lag[t<span class="dv">-1</span>] <span class="sc">+</span> noise[t]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb11-11"><a href="session-1-time-series-and-forecasting.html#cb11-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-12"><a href="session-1-time-series-and-forecasting.html#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="session-1-time-series-and-forecasting.html#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="session-1-time-series-and-forecasting.html#cb11-14" aria-hidden="true" tabindex="-1"></a>lag_trend <span class="ot">&lt;-</span> lag <span class="sc">+</span> months <span class="sc">/</span> <span class="dv">48</span></span>
<span id="cb11-15"><a href="session-1-time-series-and-forecasting.html#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="session-1-time-series-and-forecasting.html#cb11-16" aria-hidden="true" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>months<span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span> noise</span>
<span id="cb11-17"><a href="session-1-time-series-and-forecasting.html#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="session-1-time-series-and-forecasting.html#cb11-18" aria-hidden="true" tabindex="-1"></a>seasonal_trend <span class="ot">&lt;-</span> seasonal <span class="sc">+</span> months <span class="sc">/</span> <span class="dv">48</span> </span></code></pre></div>
<p>Now lets create the multivariate time series object:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="session-1-time-series-and-forecasting.html#cb12-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(noise, lag, lag_trend, seasonal, seasonal_trend), </span>
<span id="cb12-2"><a href="session-1-time-series-and-forecasting.html#cb12-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb12-3"><a href="session-1-time-series-and-forecasting.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="session-1-time-series-and-forecasting.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(all)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="session-1-time-series-and-forecasting.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsdisplay</span>(all)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-18-2.png" width="672" /><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-18-3.png" width="672" /></p>
<p>Lets look at some basic statistics: which of these have a lag?</p>
<p>This plot will show the correlation between <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-\textrm{lag}}\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="session-1-time-series-and-forecasting.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(all, <span class="at">set.lags =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div id="autocorrelation-plots" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Autocorrelation plots</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="session-1-time-series-and-forecasting.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(all[,<span class="st">&#39;noise&#39;</span>], <span class="at">xlab =</span> <span class="st">&#39;Lag (years)&#39;</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="session-1-time-series-and-forecasting.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(all[,<span class="st">&#39;lag&#39;</span>], <span class="at">xlab =</span> <span class="st">&#39;Lag (years)&#39;</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="session-1-time-series-and-forecasting.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(all[,<span class="st">&#39;seasonal&#39;</span>], <span class="at">xlab =</span> <span class="st">&#39;Lag (years)&#39;</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-20-3.png" width="672" />
### Time Series Decomposition</p>
<p>We want to look at a time series in terms of its components.</p>
<p>R has a number of handy functions for basic time series analysis. Lets take a look.</p>
<p>Lets look at some of the basic components of a time series</p>
<ul>
<li>seasonal patterns</li>
<li>trend</li>
<li>residuals</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="session-1-time-series-and-forecasting.html#cb18-1" aria-hidden="true" tabindex="-1"></a>dec <span class="ot">&lt;-</span> <span class="fu">decompose</span>(all[,<span class="st">&#39;seasonal_trend&#39;</span>])</span>
<span id="cb18-2"><a href="session-1-time-series-and-forecasting.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="session-1-time-series-and-forecasting.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="session-1-time-series-and-forecasting.html#cb19-1" aria-hidden="true" tabindex="-1"></a>dec_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trend =</span> dec<span class="sc">$</span>trend, <span class="at">month =</span> months)</span>
<span id="cb19-2"><a href="session-1-time-series-and-forecasting.html#cb19-2" aria-hidden="true" tabindex="-1"></a>dec_df <span class="ot">&lt;-</span> dec_df[<span class="sc">!</span><span class="fu">is.na</span>(dec_df),]</span>
<span id="cb19-3"><a href="session-1-time-series-and-forecasting.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="session-1-time-series-and-forecasting.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">lm</span>(trend <span class="sc">~</span> month, <span class="at">data =</span> dec_df))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   0.101   0.0345        2.92 3.85e-  3
## 2 month         0.0197  0.000251     78.5  6.10e-166</code></pre>
</div>
<div id="seasonal-trend-with-loess-smoothing-stl-decomposition" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Seasonal Trend with Loess smoothing (STL) decomposition</h3>
<p>The seasonal component of the decomposed time series is very regular. The <code>acf()</code> function creates a seasonal component using the means. Lets look at a more sophisticated model - the seasonal trend with local (Loess) smoothing</p>
<p>If we are interested in a longer term trend, lets use the
Seasonal trend w/ local smoothing Loess (STL) to smooth over a few years.</p>
<ul>
<li>trend window &gt; seasonal window</li>
<li>has some rule of thumbs for estimating the parameters</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="session-1-time-series-and-forecasting.html#cb21-1" aria-hidden="true" tabindex="-1"></a>seasonal_stl <span class="ot">&lt;-</span> <span class="fu">stl</span>(all[,<span class="st">&#39;seasonal_trend&#39;</span>], <span class="at">s.window =</span> <span class="dv">6</span>)</span>
<span id="cb21-2"><a href="session-1-time-series-and-forecasting.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(seasonal_stl)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="session-1-time-series-and-forecasting.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## note how you can access each component of the decomposed time series </span></span>
<span id="cb22-2"><a href="session-1-time-series-and-forecasting.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">## plot(seasonal_stl$time.series[,c(&#39;trend&#39;, &#39;seasonal&#39;, &#39;remainder&#39;)])</span></span></code></pre></div>
</div>
<div id="now-we-can-analyze-the-trend" class="section level3" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Now we can analyze the trend</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="session-1-time-series-and-forecasting.html#cb23-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">month =</span> months, <span class="at">trend =</span> seasonal_stl<span class="sc">$</span>time.series[,<span class="st">&#39;trend&#39;</span>])</span>
<span id="cb23-2"><a href="session-1-time-series-and-forecasting.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tmp$month, tmp$trend)</span></span>
<span id="cb23-3"><a href="session-1-time-series-and-forecasting.html#cb23-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(trend <span class="sc">~</span> month, <span class="at">data =</span> tmp)</span>
<span id="cb23-4"><a href="session-1-time-series-and-forecasting.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span></code></pre></div>
<pre><code>## (Intercept)       month 
##      0.1014      0.0198</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="session-1-time-series-and-forecasting.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   0.101   0.0277        3.66 3.14e-  4
## 2 month         0.0198  0.000199     99.4  8.74e-196</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="session-1-time-series-and-forecasting.html#cb27-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="fl">0.019</span>, <span class="fl">0.0002208</span>)</span></code></pre></div>
<p>What does that coefficient ‘month’ mean?</p>
<details>
Month is the rate of change per month. Check the equation above that we used to generate the time series. What is the slope of the trend that we added?
</details>
</div>
<div id="some-time-series-model-acronyms" class="section level3" number="1.4.4">
<h3><span class="header-section-number">1.4.4</span> Some Time Series Model Acronyms</h3>
<p><strong>ARIMA Models</strong></p>
<p>You will often see time series models specified as <strong>ARIMA(p,d,q)</strong></p>
<p><strong>AR: AutoRegressive time series</strong>
<strong>I: Integrated</strong>
<strong>MA: Moving Average smoothing</strong></p>
<ul>
<li>p number of lags</li>
<li>d degree of differencing</li>
<li>q size of moving average window</li>
</ul>
<p>The <code>forecast::auto.arima</code> function automatically fits these parameters. See <a href="https://otexts.com/fpp2/arima-r.html" class="uri">https://otexts.com/fpp2/arima-r.html</a> for an explanation of how this function works.</p>
<p><strong>STL</strong> Seasonal Seasonal Decomposition of Time Series by Loess. Extracts trend, seasonal, and locally smoothed moving average (described above).</p>
<p><strong>ETS</strong> Exponential smoothing state space model.</p>
</div>
<div id="state-space-models" class="section level3" number="1.4.5">
<h3><span class="header-section-number">1.4.5</span> State Space Models</h3>
<ol style="list-style-type: decimal">
<li>Latent variable - this is the process of interest. Not directly measured, but measured with an ‘observation model’ a.k.a. whatever is used to actually measure - often boils down to changes in an electric current that capture a property of interest.</li>
</ol>
<p>It could be a model of a pendulum or similar dynamical system.</p>
<p><a href="https://upload.wikimedia.org/wikipedia/commons/2/24/Oscillating_pendulum.gif" class="uri">https://upload.wikimedia.org/wikipedia/commons/2/24/Oscillating_pendulum.gif</a></p>
<p><a href="https://commons.wikimedia.org/wiki/File:Oscillating_pendulum.gif">Ruryk</a>, <a href="https://creativecommons.org/licenses/by-sa/3.0">CC BY-SA 3.0</a>, via Wikimedia Commons</p>
<p>Imagine you are interested in ‘growth rate.’ Then you measure the size (how? mass? length?…) of your tree, fish, or other organism of interest. Yesterday, today, and tomorrow. You can then estimate the growth rate by these differences. In turn, the growth rate could also be controlled by time, temperature, resource availability. These might each have its own latent and observed variables.</p>
<ol start="2" style="list-style-type: decimal">
<li>State-space models</li>
</ol>
<p>State space models are models of how the state of a system changes over time.</p>
<p>A state-space They provide a series of equations that represent how a system evolves in time. These models are widely used in the study of complex systems.</p>
<p>For example, a model of population dynamics that accounts for growth, reproduction, and death, geophysical at a particular place. Rocket scientists and robotics engineers, car manufacturers and video game designers all use complex models of a system that function in this way.</p>
<p>Such a model can take parameters for equations that control the the dynamics of the system (e.g ‘growth rate’). you know the state of a system, and how the system changes in time, you can use a state-space framework. once it represents the current state, it can be represent the state of a system. Conceptually, they are a way of modeling time series when you have a model of the ‘process’ or mechanism that moves the system state from <span class="math inline">\(t\)</span> to <span class="math inline">\(t+1\)</span>.</p>
<p>The ‘state’ of the system may be partially unobserved. But we can infer these states based on observations.</p>
<p>The concept of a ‘data generating process’ is an important concept when modeling, and when synthesizing data from many different locations. A ‘data generating process’ includes both the system being studied and the tools used to observe. It is common to hear people refer to data as if it is the truth. But data can only represent an incomplete view of the system itself. In the end both data and models are representations of a system.</p>
<p>Consider satellite imagery, radiative transfer models.</p>
</div>
</div>
<div id="ecological-forecasting" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Ecological Forecasting</h2>
<p>Like time series, forecasting is a very large area of research.</p>
<p>Ecological forecasting is an emerging discipline, and it covers both basic research and the application of ecological understanding to applications. Forecasts can help provide insights into the future state of a system as well as provide guidance on management scenarios.</p>
<p>That is exactly what it sounds like you need to do!</p>
<p>Some examples of ecological forecasting problems:</p>
<p>Where is the hurricane going to end up?</p>
<p>How much carbon can the land store?</p>
<p>How will flooding affect delta planton and fish populations?</p>
<p>Predict the potential yield of different crops under future climates</p>
<p><img src="images/davis-agave.png" /></p>
<p>Predict forest green up and senescence</p>
<p><img src="images/efi_phenology.png" /></p>
<p>Key references include Clark et al 2001 and Dietze et al 2018 below. The Ecological Forecasting Initiative (EFI, <a href="https://ecoforecast.org/">ecoforecast.org</a>) is a Research Coordination Network that you can join to learn and contribute to the development of this field.</p>
<div id="forecasting-challenges" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Forecasting Challenges</h3>
<p>There are a variety of forecasting challenges. These can be found on sites like Kaggle. Lets look at a few</p>
<ul>
<li><a href="https://ecoforecast.org/efi-rcn-forecast-challenges/">EFI NEON forecasting Challenge</a>
<ul>
<li>phenology, net ecosystem exchange, beetle abundance, water temperature and dissolved oxygen</li>
</ul></li>
<li>Kaggle: <a href="https://www.kaggle.com/c/sorghum-biomass-prediction/">Predict end of season Sorghum biomass from photograps</a></li>
<li>HiveMind / Agrimetrics UK Wheat yield forecast market <a href="https://agrimetrics.co.uk/2021/10/20/uk-2021-wheat-yield-prediction/">Yield 21</a></li>
</ul>
<p>A note on challenges. Framing a problem as a challenge is a great way to engage the machine learning world. And these challenges provide a way to engage other communities, and lower the barrier to entry and more level playing field than many scientific pursuits. For challenges like those on Kaggle and the ones run by EFI, the best model wins.</p>
</div>
<div id="the-forecasting-toolbox" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> The forecasting toolbox</h3>
<p>As we discussed last week, there are some simple or ‘naiive’ ways to forecast. These approaches are useful, sometimes because they perform well and other times because they provide a reasonable null hypothesis. Some use the same methods that we used to interpolate.</p>
<p>The <code>forecast</code> package has a lot of handy functions for time series data. Lets start with the moving average.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="session-1-time-series-and-forecasting.html#cb28-1" aria-hidden="true" tabindex="-1"></a>ts_fit <span class="ot">&lt;-</span> <span class="fu">tslm</span>(all[,<span class="st">&#39;seasonal_trend&#39;</span>] <span class="sc">~</span> trend <span class="sc">+</span> season, <span class="at">data =</span> all)</span>
<span id="cb28-2"><a href="session-1-time-series-and-forecasting.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## tslm(formula = all[, &quot;seasonal_trend&quot;] ~ trend + season, data = all)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3808 -0.7578  0.0051  0.6621  3.0736 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.174807   0.254138    4.62  6.4e-06 ***
## trend        0.019863   0.000956   20.78  &lt; 2e-16 ***
## season2      0.439280   0.324043    1.36  0.17657    
## season3      0.775615   0.324047    2.39  0.01750 *  
## season4      0.887002   0.324054    2.74  0.00669 ** 
## season5     -0.212659   0.324064   -0.66  0.51234    
## season6     -1.131134   0.324077   -3.49  0.00058 ***
## season7     -2.111843   0.324092   -6.52  4.6e-10 ***
## season8     -2.964434   0.324111   -9.15  &lt; 2e-16 ***
## season9     -2.842331   0.324132   -8.77  4.3e-16 ***
## season10    -2.761288   0.324156   -8.52  2.3e-15 ***
## season11    -1.882951   0.324183   -5.81  2.1e-08 ***
## season12    -1.199555   0.324212   -3.70  0.00027 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.02 on 227 degrees of freedom
## Multiple R-squared:  0.786,  Adjusted R-squared:  0.775 
## F-statistic: 69.4 on 12 and 227 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="session-1-time-series-and-forecasting.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(ts_fit, <span class="at">h =</span> <span class="dv">20</span>))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Now if you aren’t careful, it can automagically fit some fancy model. In this case, the STL+ETS(A,A,N). Is a combination of a Seasonal Trend with Loess and an Exponential smoothing state space model.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="session-1-time-series-and-forecasting.html#cb31-1" aria-hidden="true" tabindex="-1"></a>ts_fit <span class="ot">&lt;-</span> <span class="fu">stlf</span>(all[,<span class="st">&#39;seasonal_trend&#39;</span>])</span>
<span id="cb31-2"><a href="session-1-time-series-and-forecasting.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(ts_fit))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="session-1-time-series-and-forecasting.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts_fit)</span></code></pre></div>
<pre><code>## 
## Forecast method: STL +  ETS(A,A,N)
## 
## Model Information:
## ETS(A,A,N) 
## 
## Call:
##  ets(y = na.interp(x), model = etsmodel, allow.multiplicative.trend = allow.multiplicative.trend) 
## 
##   Smoothing parameters:
##     alpha = 0.0012 
##     beta  = 1e-04 
## 
##   Initial states:
##     l = 0.2543 
##     b = 0.0196 
## 
##   sigma:  0.943
## 
##  AIC AICc  BIC 
## 1293 1293 1311 
## 
## Error measures:
##                   ME  RMSE   MAE   MPE MAPE  MASE   ACF1
## Training set -0.0213 0.935 0.763 -67.6  137 0.672 -0.128
## 
## Forecasts:
##        Point Forecast Lo 80 Hi 80 Lo 95 Hi 95
## Jan 21           5.42  4.21  6.63 3.573  7.27
## Feb 21           6.08  4.87  7.29 4.234  7.93
## Mar 21           7.35  6.14  8.56 5.500  9.20
## Apr 21           7.20  5.99  8.41 5.353  9.05
## May 21           5.80  4.59  7.01 3.953  7.65
## Jun 21           4.81  3.60  6.02 2.958  6.66
## Jul 21           3.66  2.45  4.86 1.807  5.50
## Aug 21           2.83  1.62  4.03 0.976  4.67
## Sep 21           3.04  1.83  4.25 1.188  4.89
## Oct 21           3.04  1.83  4.25 1.189  4.89
## Nov 21           3.91  2.70  5.11 2.057  5.75
## Dec 21           5.09  3.88  6.29 3.237  6.93
## Jan 22           5.65  4.44  6.86 3.802  7.50
## Feb 22           6.31  5.10  7.52 4.462  8.16
## Mar 22           7.58  6.37  8.79 5.728  9.43
## Apr 22           7.43  6.22  8.64 5.581  9.28
## May 22           6.03  4.82  7.24 4.181  7.88
## Jun 22           5.04  3.83  6.24 3.187  6.88
## Jul 22           3.88  2.68  5.09 2.035  5.73
## Aug 22           3.05  1.84  4.26 1.205  4.90
## Sep 22           3.27  2.06  4.47 1.417  5.11
## Oct 22           3.27  2.06  4.48 1.418  5.12
## Nov 22           4.13  2.93  5.34 2.286  5.98
## Dec 22           5.31  4.11  6.52 3.466  7.16</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="session-1-time-series-and-forecasting.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(ts_fit, <span class="at">h =</span> <span class="dv">20</span>))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
</div>
</div>
<div id="your-turn---some-actual-data" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Your Turn - Some Actual Data!</h2>
<div id="example-1-a-twenty-year-history-of-weather-in-maricopa-az" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Example 1: A twenty year history of weather in Maricopa, AZ</h3>
<p>We looked at this lastweek.</p>
<p>These are daily statistics from ‘DayMet.’ Daymet isn’t actually observed data - it is ‘imputed’ data. So, it is available for everywhere in the continental US from 1980 on a 1km grid.</p>
<p>We will also use it in the model analysis lesson to compare this imputed ‘model’ data with ground truth observations.</p>
<p>You can learn more about it here: <a href="https://daymet.ornl.gov/" class="uri">https://daymet.ornl.gov/</a> and Thornton et al 2021.</p>
<p>While we have a sample of the dataset in the lesson repository for a particular site, it is useful to know how to access the data for your site.</p>
<p>Just change the lat, lon, start and end times to look at your favorite site!</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="session-1-time-series-and-forecasting.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(daymetr)</span>
<span id="cb35-2"><a href="session-1-time-series-and-forecasting.html#cb35-2" aria-hidden="true" tabindex="-1"></a>mac_daymet_list <span class="ot">&lt;-</span> <span class="fu">download_daymet</span>(<span class="at">site =</span> <span class="st">&quot;Maricopa Agricultural Center&quot;</span>,</span>
<span id="cb35-3"><a href="session-1-time-series-and-forecasting.html#cb35-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lat =</span> <span class="fl">33.068941</span>,</span>
<span id="cb35-4"><a href="session-1-time-series-and-forecasting.html#cb35-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lon =</span>  <span class="sc">-</span><span class="fl">111.972244</span>,</span>
<span id="cb35-5"><a href="session-1-time-series-and-forecasting.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">start =</span> <span class="dv">2000</span>,</span>
<span id="cb35-6"><a href="session-1-time-series-and-forecasting.html#cb35-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">end =</span> <span class="dv">2020</span>, <span class="at">internal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-7"><a href="session-1-time-series-and-forecasting.html#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="session-1-time-series-and-forecasting.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="session-1-time-series-and-forecasting.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables, create a date column</span></span>
<span id="cb35-10"><a href="session-1-time-series-and-forecasting.html#cb35-10" aria-hidden="true" tabindex="-1"></a>mac_daymet <span class="ot">&lt;-</span> mac_daymet_list<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="session-1-time-series-and-forecasting.html#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">date =</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(year, <span class="st">&#39;01-01&#39;</span>))<span class="sc">+</span> <span class="fu">days</span>(yday) <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb35-12"><a href="session-1-time-series-and-forecasting.html#cb35-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">precip =</span> prcp..mm.day., </span>
<span id="cb35-13"><a href="session-1-time-series-and-forecasting.html#cb35-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">tmax =</span> tmax..deg.c.,</span>
<span id="cb35-14"><a href="session-1-time-series-and-forecasting.html#cb35-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">tmin =</span> tmin..deg.c.,</span>
<span id="cb35-15"><a href="session-1-time-series-and-forecasting.html#cb35-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tmean =</span> (tmax <span class="sc">+</span> tmin) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb35-16"><a href="session-1-time-series-and-forecasting.html#cb35-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trange =</span> tmax <span class="sc">-</span> tmin,</span>
<span id="cb35-17"><a href="session-1-time-series-and-forecasting.html#cb35-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">srad =</span> srad..W.m.<span class="fl">2.</span>,</span>
<span id="cb35-18"><a href="session-1-time-series-and-forecasting.html#cb35-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">vpd =</span> vp..Pa.) </span>
<span id="cb35-19"><a href="session-1-time-series-and-forecasting.html#cb35-19" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(mac_daymet, <span class="at">file =</span> <span class="st">&#39;../data/mac_daymet.csv&#39;</span>)</span></code></pre></div>
<p>Lets read in and look at the data</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="session-1-time-series-and-forecasting.html#cb36-1" aria-hidden="true" tabindex="-1"></a>mac_daymet <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&#39;../data/mac_daymet.csv&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="session-1-time-series-and-forecasting.html#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(date, precip, tmean, srad, vpd)</span></code></pre></div>
<pre><code>## Rows: 7665 Columns: 8</code></pre>
<pre><code>## ── Column specification ───────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (7): precip, tmax, tmin, tmean, trange, srad, vpd
## date (1): date</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="session-1-time-series-and-forecasting.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mac_daymet)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   date       precip tmean  srad   vpd
##   &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 2000-01-01      0 12.2   203.  936.
## 2 2000-01-02      0  8.24  225.  680.
## 3 2000-01-03      0  6.72  284.  504.
## 4 2000-01-04      0  8.92  287.  582.
## 5 2000-01-05      0  8.86  292.  566.
## 6 2000-01-06      0  8.45  288.  566.</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="session-1-time-series-and-forecasting.html#cb42-1" aria-hidden="true" tabindex="-1"></a>tmean.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(mac_daymet<span class="sc">$</span>tmean, </span>
<span id="cb42-2"><a href="session-1-time-series-and-forecasting.html#cb42-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb42-3"><a href="session-1-time-series-and-forecasting.html#cb42-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">365</span>), </span>
<span id="cb42-4"><a href="session-1-time-series-and-forecasting.html#cb42-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">deltat =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb42-5"><a href="session-1-time-series-and-forecasting.html#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="session-1-time-series-and-forecasting.html#cb42-6" aria-hidden="true" tabindex="-1"></a>mac_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(mac_daymet, </span>
<span id="cb42-7"><a href="session-1-time-series-and-forecasting.html#cb42-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb42-8"><a href="session-1-time-series-and-forecasting.html#cb42-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">365</span>), </span>
<span id="cb42-9"><a href="session-1-time-series-and-forecasting.html#cb42-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">deltat =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>)</span></code></pre></div>
<p>Lets take a look</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="session-1-time-series-and-forecasting.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmean.ts, <span class="at">ylab =</span> <span class="st">&quot;Daily mean T&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="session-1-time-series-and-forecasting.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(tmean.ts, <span class="at">set.lags =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">180</span>, <span class="dv">360</span>))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="autocorrelation" class="section level3" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Autocorrelation</h3>
<p>The lag plot shows the correlation between each point and the points at t+1. We can see that the interpolation between every other point.</p>
<p>Lets get some monthly temperature data and start working with that.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="session-1-time-series-and-forecasting.html#cb45-1" aria-hidden="true" tabindex="-1"></a>tmean_mo <span class="ot">&lt;-</span> mac_daymet <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="session-1-time-series-and-forecasting.html#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date), <span class="at">month =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="session-1-time-series-and-forecasting.html#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="session-1-time-series-and-forecasting.html#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">tmean =</span> <span class="fu">mean</span>(tmean), <span class="at">.groups =</span> <span class="st">&#39;keep&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="session-1-time-series-and-forecasting.html#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="session-1-time-series-and-forecasting.html#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(tmean)</span>
<span id="cb45-7"><a href="session-1-time-series-and-forecasting.html#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="session-1-time-series-and-forecasting.html#cb45-8" aria-hidden="true" tabindex="-1"></a>tmean.mo.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(tmean_mo, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">12</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb45-9"><a href="session-1-time-series-and-forecasting.html#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="session-1-time-series-and-forecasting.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(tmean.mo.ts, <span class="at">lags =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="session-1-time-series-and-forecasting.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">acf</span>(tmean.mo.ts))</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<p>Your turn - decompose, plot, look at a lag plot, acf, fit using auto.arima.</p>
<p>which of the other variables are similar to temperature? Which are most different?</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="session-1-time-series-and-forecasting.html#cb47-1" aria-hidden="true" tabindex="-1"></a>vpd_mo <span class="ot">&lt;-</span> mac_daymet <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="session-1-time-series-and-forecasting.html#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date), <span class="at">month =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="session-1-time-series-and-forecasting.html#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="session-1-time-series-and-forecasting.html#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">vpd =</span> <span class="fu">mean</span>(vpd), <span class="at">.groups =</span> <span class="st">&#39;keep&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="session-1-time-series-and-forecasting.html#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-6"><a href="session-1-time-series-and-forecasting.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(vpd)</span>
<span id="cb47-7"><a href="session-1-time-series-and-forecasting.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="session-1-time-series-and-forecasting.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(vpd_mo, <span class="at">lags =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="session-1-time-series-and-forecasting.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(vpd_mo)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="session-1-time-series-and-forecasting.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(tmean_mo, vpd_mo)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-33-3.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="session-1-time-series-and-forecasting.html#cb50-1" aria-hidden="true" tabindex="-1"></a>ma_tmean <span class="ot">&lt;-</span> <span class="fu">ma</span>(tmean.mo.ts, <span class="at">order =</span> <span class="dv">13</span>, <span class="at">centre =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-2"><a href="session-1-time-series-and-forecasting.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma_tmean, <span class="at">xlab =</span> <span class="st">&#39;Year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;trend&#39;</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="session-1-time-series-and-forecasting.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmean.mo.ts) <span class="sc">+</span></span>
<span id="cb51-2"><a href="session-1-time-series-and-forecasting.html#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(ma_tmean)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<pre><code>## integer(0)</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="session-1-time-series-and-forecasting.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmean.mo.ts <span class="sc">-</span> ma_tmean)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-34-3.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="session-1-time-series-and-forecasting.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma_tmean)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-34-4.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="session-1-time-series-and-forecasting.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(tmean.ts, <span class="at">lag.max =</span> <span class="dv">180</span>)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="session-1-time-series-and-forecasting.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What does this mean?</span></span>
<span id="cb56-2"><a href="session-1-time-series-and-forecasting.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(tmean.ts)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<p>Your Turn:</p>
<p>Plot a few of the other variables. How do the seasonal patterns and trends compare?</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="session-1-time-series-and-forecasting.html#cb57-1" aria-hidden="true" tabindex="-1"></a>precip.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(mac_daymet<span class="sc">$</span>precip, </span>
<span id="cb57-2"><a href="session-1-time-series-and-forecasting.html#cb57-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb57-3"><a href="session-1-time-series-and-forecasting.html#cb57-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">365</span>), </span>
<span id="cb57-4"><a href="session-1-time-series-and-forecasting.html#cb57-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">deltat =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb57-5"><a href="session-1-time-series-and-forecasting.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(precip.ts)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="session-1-time-series-and-forecasting.html#cb58-1" aria-hidden="true" tabindex="-1"></a>vpd.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(mac_daymet<span class="sc">$</span>vpd, </span>
<span id="cb58-2"><a href="session-1-time-series-and-forecasting.html#cb58-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb58-3"><a href="session-1-time-series-and-forecasting.html#cb58-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">365</span>), </span>
<span id="cb58-4"><a href="session-1-time-series-and-forecasting.html#cb58-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">deltat =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb58-5"><a href="session-1-time-series-and-forecasting.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="session-1-time-series-and-forecasting.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(vpd.ts, )</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="session-1-time-series-and-forecasting.html#cb59-1" aria-hidden="true" tabindex="-1"></a>all.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(mac_daymet, </span>
<span id="cb59-2"><a href="session-1-time-series-and-forecasting.html#cb59-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb59-3"><a href="session-1-time-series-and-forecasting.html#cb59-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">365</span>), </span>
<span id="cb59-4"><a href="session-1-time-series-and-forecasting.html#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">deltat =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb59-5"><a href="session-1-time-series-and-forecasting.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lag.plot</span>(all.ts)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="session-1-time-series-and-forecasting.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(vpd.ts, precip.ts)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="session-1-time-series-and-forecasting.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(precip.ts, tmean.ts)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-36-5.png" width="672" /></p>
<p><a href="https://cals.arizona.edu/azmet/06.htm" class="uri">https://cals.arizona.edu/azmet/06.htm</a> <a href="https://cals.arizona.edu/azmet/raw2003.htm" class="uri">https://cals.arizona.edu/azmet/raw2003.htm</a></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="session-1-time-series-and-forecasting.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mac_daymet)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   date       precip tmean  srad   vpd
##   &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 2000-01-01      0 12.2   203.  936.
## 2 2000-01-02      0  8.24  225.  680.
## 3 2000-01-03      0  6.72  284.  504.
## 4 2000-01-04      0  8.92  287.  582.
## 5 2000-01-05      0  8.86  292.  566.
## 6 2000-01-06      0  8.45  288.  566.</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="session-1-time-series-and-forecasting.html#cb64-1" aria-hidden="true" tabindex="-1"></a>mac_azmet <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&#39;https://cals.arizona.edu/azmet/data/0620rd.txt&#39;</span>, </span>
<span id="cb64-2"><a href="session-1-time-series-and-forecasting.html#cb64-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col_select =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb64-3"><a href="session-1-time-series-and-forecasting.html#cb64-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;day&#39;</span>, <span class="st">&#39;hour&#39;</span>, <span class="st">&#39;air_temp&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="session-1-time-series-and-forecasting.html#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">doy =</span> day <span class="sc">+</span> hour<span class="sc">/</span><span class="dv">24</span>)</span></code></pre></div>
<pre><code>## Rows: 366 Columns: 4</code></pre>
<pre><code>## ── Column specification ───────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (4): year, day, hour, air_temp</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="session-1-time-series-and-forecasting.html#cb68-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">acf</span>(mac_azmet<span class="sc">$</span>air_temp)</span></code></pre></div>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
</div>
<div id="growth-curves" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Growth Curves</h2>
<p>This is from the NEON Ecological Forecasting Initiative Challenge</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="session-1-time-series-and-forecasting.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-2"><a href="session-1-time-series-and-forecasting.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb69-3"><a href="session-1-time-series-and-forecasting.html#cb69-3" aria-hidden="true" tabindex="-1"></a>gcc <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&#39;https://data.ecoforecast.org/targets/phenology/phenology-targets.csv.gz&#39;</span>)</span></code></pre></div>
<pre><code>## Rows: 14320 Columns: 6</code></pre>
<pre><code>## ── Column specification ───────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (1): siteID
## dbl  (4): gcc_90, rcc_90, gcc_sd, rcc_sd
## date (1): time</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="session-1-time-series-and-forecasting.html#cb73-1" aria-hidden="true" tabindex="-1"></a>gcc_wide <span class="ot">&lt;-</span> gcc <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="session-1-time-series-and-forecasting.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(time, siteID, gcc_90) <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="session-1-time-series-and-forecasting.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> time, <span class="at">names_from =</span> siteID, <span class="at">values_from =</span> gcc_90)</span>
<span id="cb73-4"><a href="session-1-time-series-and-forecasting.html#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="session-1-time-series-and-forecasting.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gcc_wide)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##   time        HARV   BART  SCBI  STEI  UKFS  GRSM   DELA
##   &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 2016-12-13 0.329 NA     0.325    NA    NA    NA NA    
## 2 2016-12-14 0.328  0.344 0.325    NA    NA    NA NA    
## 3 2016-12-15 0.330  0.346 0.326    NA    NA    NA NA    
## 4 2016-12-16 0.329  0.342 0.326    NA    NA    NA  0.345
## 5 2016-12-17 0.332  0.350 0.326    NA    NA    NA  0.349
## 6 2016-12-18 0.332  0.348 0.327    NA    NA    NA  0.347
## # … with 1 more variable: CLBJ &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="session-1-time-series-and-forecasting.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gcc, <span class="fu">aes</span>(time, gcc_90)) <span class="sc">+</span></span>
<span id="cb75-2"><a href="session-1-time-series-and-forecasting.html#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="session-1-time-series-and-forecasting.html#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>siteID)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row(s) containing missing values
## (geom_path).</code></pre>
<p><img src="reproducible-research-short-course_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="session-1-time-series-and-forecasting.html#cb77-1" aria-hidden="true" tabindex="-1"></a>gcc_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(gcc_wide<span class="sc">$</span>BART, <span class="at">frequency =</span> <span class="dv">365</span>)</span>
<span id="cb77-2"><a href="session-1-time-series-and-forecasting.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gcc_ts)</span>
<span id="cb77-3"><a href="session-1-time-series-and-forecasting.html#cb77-3" aria-hidden="true" tabindex="-1"></a>gcc_ts_interp <span class="ot">&lt;-</span> <span class="fu">na.interp</span>((gcc_ts))</span>
<span id="cb77-4"><a href="session-1-time-series-and-forecasting.html#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="session-1-time-series-and-forecasting.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">decompose</span>(gcc_ts_interp))</span>
<span id="cb77-6"><a href="session-1-time-series-and-forecasting.html#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="session-1-time-series-and-forecasting.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(gcc_ts))</span>
<span id="cb77-8"><a href="session-1-time-series-and-forecasting.html#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="session-1-time-series-and-forecasting.html#cb77-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(gcc_ts)</span>
<span id="cb77-10"><a href="session-1-time-series-and-forecasting.html#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="session-1-time-series-and-forecasting.html#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f)</span></code></pre></div>
</div>
<div id="references" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> References</h2>
<p><strong>Daymet</strong></p>
<p>Thornton, M.M., R. Shrestha, Y. Wei, P.E. Thornton, S. Kao, and B.E. Wilson. 2020. Daymet: Daily Surface Weather Data on a 1-km Grid for North America, Version 4. ORNL DAAC, Oak Ridge, Tennessee, USA. <a href="https://doi.org/10.3334/ORNLDAAC/1840" class="uri">https://doi.org/10.3334/ORNLDAAC/1840</a></p>
<p>Daymet: Daily Surface Weather Data on a 1-km Grid for North America, Version 4 <a href="https://doi.org/10.3334/ORNLDAAC/1840" class="uri">https://doi.org/10.3334/ORNLDAAC/1840</a></p>
<p>Some of the material is based on the following courses and texts</p>
<p>Ben Bolker 2007 Ecological Models and Data in R. Princeton university press.
- The author makes a early version pre-print available on his website <a href="https://ms.mcmaster.ca/~bolker/emdbook/book.pdf" class="uri">https://ms.mcmaster.ca/~bolker/emdbook/book.pdf</a></p>
<p>Ethan White and Morgan Earnst Ecological Dynamics and Forecasting <a href="https://github.com/weecology/forecasting-course" class="uri">https://github.com/weecology/forecasting-course</a>
- Dietze, Michael. Ecological forecasting. Princeton University Press, 2017.
- Dietze, Michael. Ecological forecasting. Course materials <a href="https://github.com/EcoForecast/EF_Activities" class="uri">https://github.com/EcoForecast/EF_Activities</a></p>
<p>Hyndman, R.J., &amp; Athanasopoulos, G. (2018) Forecasting: principles and practice, 2nd edition, OTexts: Melbourne, Australia. OTexts.com/fpp2. Accessed on 2021-10-31</p>
<p>Dietze, Michael C., et al. “Iterative near-term ecological forecasting: Needs, opportunities, and challenges.” Proceedings of the National Academy of Sciences 115.7 (2018): 1424-1432. <a href="https:doi.org/10.1073/pnas.1710231115" class="uri">https:doi.org/10.1073/pnas.1710231115</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-2-web-based-data-archival.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
